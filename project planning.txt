//SQL - PROJECT PLANNING:
WITH CTE1 AS (
    SELECT start_date, RANK() OVER (ORDER BY start_date) AS Rank_Start_date
    FROM projects
    WHERE start_date NOT IN (SELECT End_date FROM projects)
),
CTE2 AS (
    SELECT end_date, RANK() OVER (ORDER BY end_date) AS Rank_End_Date
    FROM projects
    WHERE end_date NOT IN (SELECT start_date FROM projects)
)
SELECT start_date, end_date
FROM CTE1, CTE2
WHERE Rank_Start_date = Rank_End_Date
ORDER BY DATEDIFF(end_date, start_date), start_date;
